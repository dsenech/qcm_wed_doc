
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Cluster Dynamical Mean Field Theory &#8212; pyqcm v2.0.0(git hash 30c811f) documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Variational Cluster Approximation" href="vca.html" />
    <link rel="prev" title="Class model_instance" href="instances.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vca.html" title="The Variational Cluster Approximation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="instances.html" title="Class model_instance"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyqcm v2.0.0(git hash 30c811f) documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Cluster Dynamical Mean Field Theory</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="cluster-dynamical-mean-field-theory">
<h1>Cluster Dynamical Mean Field Theory<a class="headerlink" href="#cluster-dynamical-mean-field-theory" title="Permalink to this heading">¶</a></h1>
<p>This submodule provides functions that perform the CDMFT algorithm.</p>
<section id="list-of-classes">
<h2>List of classes<a class="headerlink" href="#list-of-classes" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyqcm.cdmft.CDMFT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CDMFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varia</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sharp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miniter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accur_hybrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accur_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accur_E0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Nelder-Mead'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cdmft.tsv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">averages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_algo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hartree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SEF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_ground_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_function_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_potential_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double_counting_correct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.CDMFT" title="Permalink to this definition">¶</a></dt>
<dd><p>class containing the elements of a CDMFT computation. The constructor executes the computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>varia</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – list of variational parameters 
OR tuple of two lists : bath energies and bath hybridizations
OR function that returns dicts of bath energies and bath hybridizations given numeric arrays</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – inverse fictitious temperature (for the frequency grid)</p></li>
<li><p><strong>wc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – cutoff frequency (for the frequency grid)</p></li>
<li><p><strong>grid_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – type of frequency grid along the imaginary axis : ‘sharp’, ‘ifreq’, ‘self’</p></li>
<li><p><strong>maxiter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – maximum number of CDMFT iterations</p></li>
<li><p><strong>miniter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – minimum number of CDMFT iterations</p></li>
<li><p><strong>accur</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the procedure converges if parameters do not change by more than accur</p></li>
<li><p><strong>accur_hybrid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the procedure converges on the hybridization function with this accuracy</p></li>
<li><p><strong>accur_dist</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – convergence criterion when minimizing the distance function.</p></li>
<li><p><strong>accur_E0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – convergence criterion on the impurity ground state energy.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – damping parameter (fraction of the previous iteration in the new one) OR (float,int) with number of iterations where damping is used (at the beginning if positive, at the end if negative)</p></li>
<li><p><strong>displaymin</strong> (<em>boolean</em>) – displays the minimum distance function when minimized</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – method to use, as used in scipy.optimize.minimize()</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of the file where the solution is written</p></li>
<li><p><strong>averages</strong> (<em>boolean</em>) – if True, computes the lattice averages after each iteration. Computes them at the end anyway.</p></li>
<li><p><strong>eps_algo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of elements in the epsilon algorithm convergence accelerator = 2*eps_algo + 1 (0 = no acceleration)</p></li>
<li><p><strong>initial_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – initial step in the minimization routine</p></li>
<li><p><strong>hartree</strong> (<em>[</em><a class="reference internal" href="hartree.html#pyqcm.hartree" title="pyqcm.hartree"><em>hartree</em></a><em>]</em>) – mean-field hartree couplings to incorportate in the convergence procedure</p></li>
<li><p><strong>SEF</strong> (<em>boolean</em>) – if True, computes the Potthoff functional at the end</p></li>
<li><p><strong>check_ground_state</strong> (<em>boolean</em>) – if True, checks the ground state consistency and raises exception if inconsistent</p></li>
<li><p><strong>[</strong><strong>observable</strong><strong>]</strong> – list of observables used to assess convergence</p></li>
<li><p><strong>verb</strong> (<em>boolean</em>) – If True, prints debugging information</p></li>
<li><p><strong>max_function_eval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – maximum number of distance function evaluations when minimizing distance</p></li>
<li><p><strong>compute_potential_energy</strong> (<em>boolean</em>) – If True, computes Tr(Sigma*G) along with the averages</p></li>
<li><p><strong>double_counting_correct</strong> (<em>[</em><em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>)</em><em>]</em>) – list of recipes for double counting corrections: (kinetic operator, interaction operator, density operator, coefficient, value of the kinetic operator without interaction)    :returns: None</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model_classes.html#pyqcm.lattice_model" title="pyqcm.lattice_model"><em>lattice_model</em></a>) – (unique) model on which the computation is based</p></li>
<li><p><strong>Hyb</strong> (<em>ndarray</em>) – host function</p></li>
<li><p><strong>Hyb_down</strong> (<em>ndarray</em>) – host function for the spin down component in the case of mixing=4</p></li>
<li><p><strong>I</strong> – current model instance (changes in the course of the computation)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyqcm.cdmft.CDMFT.diff_hybrid">
<span class="sig-name descname"><span class="pre">diff_hybrid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.CDMFT.diff_hybrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a difference in hybridization functions between the current iteration (Hyb) and the previous one (Hyb0)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns float<span class="colon">:</span></dt>
<dd class="field-odd"><p>the difference in hybridization arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyqcm.cdmft.CDMFT.set_Hyb">
<span class="sig-name descname"><span class="pre">set_Hyb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.CDMFT.set_Hyb" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the hybridization function, i.e.
an array of arrays of matrices. Hyb[i], for cluster #i, is a (nw,d,d) Numpy array. with nw frequencies, and d sites</p>
<p>:returns None</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyqcm.cdmft.frequency_grid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">frequency_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sharp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.frequency_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>This class contains the imaginary frequency grid data, including weights</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<a class="reference internal" href="instances.html#pyqcm.model_instance" title="pyqcm.model_instance"><em>model_instance</em></a>) – current model instance</p></li>
<li><p><strong>grid_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – type of frequency grid along the imaginary axis : ‘sharp’, ‘ifreq’, ‘self’</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – inverse fictitious temperature (for the frequency grid)</p></li>
<li><p><strong>wc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – cutoff frequency (for the frequency grid)</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – inverse fictitious temperature</p></li>
<li><p><strong>wc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – cutoff frequency (for the frequency grid)</p></li>
<li><p><strong>grid_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – type of frequency grid along the imaginary axis : ‘sharp’, ‘ifreq’, ‘self’</p></li>
<li><p><strong>wr</strong> – array of frequencies (real array, i.e., imaginary part of the frequencies)</p></li>
<li><p><strong>weight</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>]</em>) – array of weights for the different frequencies of the grid</p></li>
<li><p><strong>nw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of frequencies in the grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyqcm.cdmft.hybridization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hybridization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.hybridization" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines hybridization data from a data file.
the frequency is purely imaginary; it is its imaginary part that appears in the file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of the file or string. Format : each line starts with a frequency and then has N*N columns for Delta_{ij}(w)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyqcm.cdmft.hybridization.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.hybridization.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the distance function bewteen the data and the hybridization function of an impurity model instance of label I</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>I</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – label of the impurity model instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyqcm.cdmft.hybridization.optimize_bath">
<span class="sig-name descname"><span class="pre">optimize_bath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">varia</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Nelder-Mead'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accur</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accur_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.hybridization.optimize_bath" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimizes the bath parameters to fit the hybridization function delta
:param [str] varia: list of variational parameters (bath parameters) from PyQCM
:param [float] x: starting values of the parameters</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyqcm.cdmft.general_bath">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">general_bath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'clus'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_dependent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">singlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.general_bath" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that construct a cluster model with nb bath orbitals, in the most general way possible, with possible restrictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of the cluster-bath model to be defined</p></li>
<li><p><strong>ns</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of sites in the cluster</p></li>
<li><p><strong>nb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of bath orbitals in the cluster</p></li>
<li><p><strong>spin_dependent</strong> (<em>boolean</em>) – if True, the parameters are spin dependent</p></li>
<li><p><strong>spin_flip</strong> (<em>boolean</em>) – if True, spin-flip hybridizations are present</p></li>
<li><p><strong>singlet</strong> (<em>boolean</em>) – if True, defines anomalous singlet hybridizations</p></li>
<li><p><strong>triplet</strong> (<em>boolean</em>) – if True, defines anomalous triplet hybridizations</p></li>
<li><p><strong>complex</strong> (<em>boolean</em>) – if True, defines imaginary parts as well, when appropriate</p></li>
<li><p><strong>sites</strong> (<em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>]</em><em>]</em>) – 2-level list of sites to couple to the bath orbitals (labels from 1 to ns). Format resembles [[site labels to bind to orbital 1], …] .</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ns</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of physical sites in the cluster</p></li>
<li><p><strong>nb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of bath orbitals in the cluster</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of the cluster model</p></li>
<li><p><strong>var_E</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – list of bath parameters of the type “energy level”</p></li>
<li><p><strong>var_H</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – list of bath parameters of the type “hybridization”</p></li>
<li><p><strong>spin_dependent</strong> (<em>boolean</em>) – True if the bath parameter conserve spin, but are different for spins up and down</p></li>
<li><p><strong>spin_flip</strong> (<em>boolean</em>) – True if we include spin-flip hybridizations terms</p></li>
<li><p><strong>singlet</strong> (<em>boolean</em>) – True if we include anomalous hybridizations of the singlet type</p></li>
<li><p><strong>triplet</strong> (<em>boolean</em>) – True if we include anomalous hybridizations of the triplet type</p></li>
<li><p><strong>complex</strong> (<em>boolean</em>) – True if the model is complex-valued and thus hybridization operators have both real and imaginary components</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyqcm.cdmft.general_bath.starting_values">
<span class="sig-name descname"><span class="pre">starting_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">1.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shyb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.1,</span> <span class="pre">0.05)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.general_bath.starting_values" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an initialization string for the bath parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – cluster label (starts at 1)</p></li>
<li><p><strong>e</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>)</em>) – bounds of the values for the bath energies (absolute value)</p></li>
<li><p><strong>hyb</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>)</em>) – average and deviation of the normal hybridization parameters</p></li>
<li><p><strong>shyb</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>)</em>) – average and deviation of the anomalous hybridization parameters</p></li>
<li><p><strong>pr</strong> (<em>boolean</em>) – prints the starting values if True</p></li>
</ul>
</dd>
<dt class="field-even">Return str<span class="colon">:</span></dt>
<dd class="field-even"><p>initialization string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyqcm.cdmft.general_bath.starting_values_PH">
<span class="sig-name descname"><span class="pre">starting_values_PH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.general_bath.starting_values_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an initialization string for the bath parameters, in the particle-hole symmetric case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – cluster label</p></li>
<li><p><strong>e</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>)</em>) – range of bath energies</p></li>
<li><p><strong>hyb</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>)</em>) – average and deviation of the normal hybridization parameters</p></li>
<li><p><strong>phi</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>]</em>) – PH phases of the cluster sites proper</p></li>
<li><p><strong>pr</strong> (<em>boolean</em>) – if True, prints info</p></li>
</ul>
</dd>
<dt class="field-even">Return str<span class="colon">:</span></dt>
<dd class="field-even"><p>initialization string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyqcm.cdmft.general_bath.varia">
<span class="sig-name descname"><span class="pre">varia</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_down</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.general_bath.varia" title="Permalink to this definition">¶</a></dt>
<dd><p>creates a dict of variational parameters to values taken from the hybridization matrix H and the energies E, for cluster c</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>ndarray</em>) – matrix of hybridization values</p></li>
<li><p><strong>E</strong> (<em>ndarray</em>) – array of energy values</p></li>
<li><p><strong>spin_down</strong> (<em>boolean</em>) – True for the spin-down values</p></li>
</ul>
</dd>
<dt class="field-even">Return {str,float}<span class="colon">:</span></dt>
<dd class="field-even"><p>dict of variational parameters to values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyqcm.cdmft.general_bath.varia_E">
<span class="sig-name descname"><span class="pre">varia_E</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.general_bath.varia_E" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a list of parameter names from the bath energies with the suffix appropriate for cluster c</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – label of the cluster (starts at 1)</p>
</dd>
<dt class="field-even">Return [str]<span class="colon">:</span></dt>
<dd class="field-even"><p>list of parameter names from the bath energies with the suffix appropriate for cluster c</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyqcm.cdmft.general_bath.varia_H">
<span class="sig-name descname"><span class="pre">varia_H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.general_bath.varia_H" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a list of parameter names from the bath hybridization with the suffix appropriate for cluster c</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – label of the cluster (starts at 1)</p>
</dd>
<dt class="field-even">Return [str]<span class="colon">:</span></dt>
<dd class="field-even"><p>list of parameter names from the bath hybridization with the suffix appropriate for cluster c</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyqcm.cdmft.observable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqcm.cdmft.observable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Cluster Dynamical Mean Field Theory</a><ul>
<li><a class="reference internal" href="#list-of-classes">List of classes</a><ul>
<li><a class="reference internal" href="#pyqcm.cdmft.CDMFT"><code class="docutils literal notranslate"><span class="pre">CDMFT</span></code></a><ul>
<li><a class="reference internal" href="#pyqcm.cdmft.CDMFT.diff_hybrid"><code class="docutils literal notranslate"><span class="pre">diff_hybrid()</span></code></a></li>
<li><a class="reference internal" href="#pyqcm.cdmft.CDMFT.set_Hyb"><code class="docutils literal notranslate"><span class="pre">set_Hyb()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyqcm.cdmft.frequency_grid"><code class="docutils literal notranslate"><span class="pre">frequency_grid</span></code></a></li>
<li><a class="reference internal" href="#pyqcm.cdmft.hybridization"><code class="docutils literal notranslate"><span class="pre">hybridization</span></code></a><ul>
<li><a class="reference internal" href="#pyqcm.cdmft.hybridization.distance"><code class="docutils literal notranslate"><span class="pre">distance()</span></code></a></li>
<li><a class="reference internal" href="#pyqcm.cdmft.hybridization.optimize_bath"><code class="docutils literal notranslate"><span class="pre">optimize_bath()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyqcm.cdmft.general_bath"><code class="docutils literal notranslate"><span class="pre">general_bath</span></code></a><ul>
<li><a class="reference internal" href="#pyqcm.cdmft.general_bath.starting_values"><code class="docutils literal notranslate"><span class="pre">starting_values()</span></code></a></li>
<li><a class="reference internal" href="#pyqcm.cdmft.general_bath.starting_values_PH"><code class="docutils literal notranslate"><span class="pre">starting_values_PH()</span></code></a></li>
<li><a class="reference internal" href="#pyqcm.cdmft.general_bath.varia"><code class="docutils literal notranslate"><span class="pre">varia()</span></code></a></li>
<li><a class="reference internal" href="#pyqcm.cdmft.general_bath.varia_E"><code class="docutils literal notranslate"><span class="pre">varia_E()</span></code></a></li>
<li><a class="reference internal" href="#pyqcm.cdmft.general_bath.varia_H"><code class="docutils literal notranslate"><span class="pre">varia_H()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyqcm.cdmft.observable"><code class="docutils literal notranslate"><span class="pre">observable</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="instances.html"
                          title="previous chapter">Class model_instance</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="vca.html"
                          title="next chapter">The Variational Cluster Approximation</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/cdmft.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vca.html" title="The Variational Cluster Approximation"
             >next</a> |</li>
        <li class="right" >
          <a href="instances.html" title="Class model_instance"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyqcm v2.0.0(git hash 30c811f) documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Cluster Dynamical Mean Field Theory</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, David Sénéchal.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>